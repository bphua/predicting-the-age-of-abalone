---
title: 'Group Project: T09; DS6'
author: '450132759, 450237777, 470315518'
date: "October 5, 2018"
output: 
  prettydoc::html_pretty:
    theme: cayman # prettydoc theme
    highlight: null # syntax highlighting
---
<!-- Please run install.packages("prettydoc") and library(prettydoc) before knitting -->
<style>
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono');
@import url('https://fonts.googleapis.com/css?family=Lato');
body{
  font-family: 'Lato' !important;
  font-size: 12pt;
}

code{
  font-family: 'Roboto Mono' !important;
  font-size: 12px;
}

pre{
  font-family: 'Roboto Mono' !important;
  font-size: 12px
}

td{
  font-family: Lato !important;
  font-size: 12pt;
}
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, fig.align = "center")
```

## Abstract
<!-- A one paragraph summary of what you set out to learn, and what you ended up finding. It should summarise the entire report. -->


## Introduction
<!-- A discussion of what questions you are trying to answer. -->


## Data Set
<!-- Describe details about how the data set was collected (if known) and the variables in the data set. -->

### Importing Data

```{r import}
data = read.table("https://archive.ics.uci.edu/ml/machine-learning-databases/abalone/abalone.data", sep = ",")
View(data)
library(tidyverse)
library(gridExtra)
glimpse(data)
```

### Cleaning 
```{r}
#install.packages("reshape")
library(reshape)
new_names <- c("Sex", "Length", "Diameter", "Height", "Whole weight", "Shucked weight", "Viscera weight", "Shell weight", "Rings")

colnames(data) <- new_names

summary(data)

#Length, Diameter, Height in mm
#Weight in g

#Outliers
melt(data) %>%
  ggplot(aes(x = variable, y = value)) +
  geom_boxplot(outlier.size=2, outlier.colour='blue') + facet_wrap(~ variable, scales = 
  "free") 

#Remove Height = 0.515mm and 1.13mm as it is greater than Q3 + (1.5*IQR) = 0.24
new_data <- subset(data, data$Height < 0.5)
ggplot(new_data, aes(y = Height)) +
geom_boxplot(outlier.size=3, outlier.colour='blue')

#Remove measurements that equals to 0 as well as weight s.t. `Shucked weight` + `Viscera weight` + `Shell weight` > `Whole weight`
new_data %>% filter(Length, Diameter, Height, `Whole weight`, `Shucked weight`, `Viscera weight`, `Shell weight` == 0) %>% filter(`Shucked weight` + `Viscera weight` + `Shell weight` > `Whole weight`)
summary(new_data)

#Multivariate Normality
#install.packages("energy")
#install.packages("mvtnorm")
library(energy)
library(mvtnorm)
data_less_sex <- new_data %>% select(-Sex)
mvnorm.e(data_less_sex)

#install.packages("MVN")
library(MVN)
result <- mvn(data = data_less_sex, mvnTest = "dh")
result$multivariateNormality
result <- mvn(data = data_less_sex, mvnTest = "dh", univariatePlot = "histogram")

# check weights
data %>%
  mutate(sum_weight = Shell_weight + Viscera_weight + Shucked_weight) %>%
  summarise(bad = sum(sum_weight > Whole_weight)) 


```


## Analysis
<!-- Describe how you used multiple regression to analyse the data set. Specifically, you should discuss how you carried out the steps in analysis discussed in class, i.e., exploration of data to find an initial reasonable model, checking the model and changes to the model based on your checking of the model. -->
```{r}
# basic testing - to get a feel for things - not necessarily for preso or report

# some stats
data %>%
  group_by(Sex) %>%
  summarize(mean_wgt = mean(Whole_weight), mean_lenght = mean(Length), mean_rings = mean(Rings), min_rings = min(Rings), max_rings = max(Rings))

# correlation pairs:
library(GGally)
#ggpairs(data)   # function takes a long time to execute.

# how many of each sex, m/f/infant
data %>%
  group_by(Sex) %>%
  summarize(n = n())


# Full model 
full_model <- lm(Rings ~ ., data = data)
summary(full_model)
t(round(broom::glance(full_model), 2))


```

## Results
<!-- Provide inferences about the questions of interest. -->


## Discussion and Conclusion
<!-- Describe any limitations of your analysis and how they might be overcome in future research and provide brief conclusions about the results of your study. -->

## References

Warwick J Nash, Tracy L Sellers, Simon R Talbot, Andrew J Cawthorn and Wes B Ford (1994) "The Population Biology of Abalone (_Haliotis_ species) in Tasmania. I. Blacklip Abalone (_H. rubra_) from the North Coast and Islands of Bass Strait", Sea Fisheries Division, Technical Report No. 48 (ISSN 1034-3288), accessed via URL:
https://archive.ics.uci.edu/ml/datasets/abalone

